<link rel="import" href="../polymer/polymer.html">

<dom-module id="sticky-panel">
	<template>
		<style>
			:host {
				display: block;
				position: -webkit-sticky;
				position: sticky;
				top: 10px;
			}
		</style>

		<slot></slot>
	</template>

	<script src="../Stickyfill/dist/stickyfill.min.js"></script>
	<script>
		class StickyPanel extends Polymer.Element {
			static get is() { return 'sticky-panel'; }
			static get properties() {
				return {
					disabled: {
						type: Boolean,
						observer: '_disabledChanged'
					}
				};
			}

			connectedCallback() {
				super.connectedCallback();

				if (!this.disabled) {
					this._updateSticky(true);
					document.addEventListener('DOMContentLoaded', function () {
						Polymer.RenderStatus.afterNextRender(this, Stickyfill.rebuild);
					});
				}
			}

			_updateSticky(sticky) {
				if (sticky) {
					Stickyfill.add(this);
				} else {
					Stickyfill.remove(this);
				}
				Stickyfill.refreshAll()
			}

			_disabledChanged(disabled) {
				this._updateSticky(!disabled)
			}
		}

		window.customElements.define(StickyPanel.is, StickyPanel);
	</script>
</dom-module>